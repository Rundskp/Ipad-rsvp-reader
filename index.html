<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b0c10" />
  <title>RSVP Reader</title>
  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <!-- Topbar -->
  <header class="topbar">
    <div class="brand">
      <div class="dot"></div>
      <div class="brandText">
        <div class="title">RSVP Reader</div>
        <div id="status" class="sub">Warte auf Datei‚Ä¶</div>
      </div>
    </div>

    <div class="topActions">
      <label class="btn">
        <input id="file" type="file" accept=".epub,.txt" hidden />
        Datei laden
      </label>

      <button id="btnSidebar" class="btn ghost" title="Kapitel / Lesezeichen">‚ò∞</button>
      <button id="btnHeader" class="btn ghost" title="Cover/Titel anzeigen">üõà</button>
      <button id="btnSettings" class="btn ghost" title="Einstellungen">‚öôÔ∏é</button>
      <button id="btnHelp" class="btn ghost" title="Hilfe">?</button>
      <button id="btnDonate" class="btn ghost" title="Spenden">‚òïÔ∏è</button>
      <button id="btnShelf" class="btn ghost" title="Bibliothek">üìö</button>
    </div>
  </header>

  <!-- Optional header info (cover + title) -->
  <section id="headerInfo" class="headerInfo hidden">
    <div class="headerInfoInner">
      <img id="coverImg" class="cover" alt="Cover" />
      <div class="meta">
        <div id="bookTitle" class="bookTitle">‚Äî</div>
        <div id="bookAuthor" class="bookAuthor">‚Äî</div>
        <div class="metaRow">
          <span class="pill"><b>Fortschritt</b> <span id="prog">0%</span></span>
          <span class="pill"><b>WPM</b> <span id="wpmVal">360</span></span>
          <span class="pill"><b>Kapitel</b> <span id="chapVal">‚Äî</span></span>
        </div>
      </div>
      <div class="pinCol">
        <label class="check small">
          <input id="pinHeader" type="checkbox" />
          fixieren
        </label>
      </div>
    </div>
  </section>

  <!-- Main -->
  <main class="wrap">
    <!-- Reader card -->
    <section class="card">
      <div class="player">
        <div class="display" id="display">
          <span class="word" id="word">‚Äî</span>
        </div>

        <div class="transport">
          <button id="btnBack" class="btn ghost" disabled>‚üµ</button>
          <button id="btnPlay" class="btn primary" disabled>Play</button>
          <button id="btnFwd" class="btn ghost" disabled>‚ü∂</button>
          <button id="btnBookmark" class="btn ghost" disabled>üîñ</button>
          <button id="btnReset" class="btn ghost" disabled>Reset</button>
          <button id="btnSaveSettings" class="btn" type="button">Speichern</button>
<button id="btnLoadSettings" class="btn ghost" type="button">Laden</button>

        </div>

        <div class="scrub">
          <input id="seek" type="range" min="0" max="0" value="0" disabled>
          <div class="hint">
            <span id="pos">0</span> / <span id="total">0</span> W√∂rter
            <span class="sep">‚Ä¢</span>
            Tippen: links zur√ºck, Mitte Play/Pause, rechts vor
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar hidden">
    <div class="sidebarHead">
      <div class="sidebarTitle">Kapitel & Lesezeichen</div>
      <button id="btnSidebarClose" class="btn ghost">‚úï</button>
    </div>

    <div class="tabs">
      <button id="tabToc" class="tab active">Kapitel</button>
      <button id="tabMarks" class="tab">Lesezeichen</button>
    </div>

    <div id="tocPane" class="pane">
      <div id="tocList" class="list muted">Noch kein Buch geladen.</div>
    </div>

    <div id="marksPane" class="pane hidden">
      <div id="marksList" class="list muted">Keine Lesezeichen.</div>
    </div>
  </aside>

  <!-- Settings modal -->
  <div id="settingsModal" class="modal hidden">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">Einstellungen</div>
        <button id="btnSettingsClose" class="btn ghost">‚úï</button>
      </div>

      <div class="controls">
        <div class="control">
          <label>Geschwindigkeit (WPM)</label>
          <input id="wpm" type="range" min="120" max="900" step="10" value="360">
        </div>

        <div class="control">
          <label>Chunk (W√∂rter pro Anzeige)</label>
          <input id="chunk" type="range" min="1" max="6" step="1" value="1">
          <div class="hint"><span id="chunkVal">1</span> Wort/W√∂rter</div>
        </div>

        <div class="control">
          <label class="check">
            <input id="orp" type="checkbox" checked>
            ORP-Highlight
          </label>
          <label class="check">
            <input id="punct" type="checkbox" checked>
            Extra-Pause bei Satzzeichen
          </label>
        </div>

        <div class="control">
          <label>Satzzeichen-Pause (ms)</label>
          <input id="punctMs" type="range" min="0" max="500" step="25" value="200">
          <div class="hint"><span id="punctVal">200</span> ms</div>
        </div>

        <hr class="hr">

        <div class="control">
          <label class="check">
            <input id="stopChapter" type="checkbox">
            Auto-Stop am Kapitelende (nicht mitten im Satz)
          </label>
          <label class="check">
            <input id="stopWordsOn" type="checkbox">
            Auto-Stop nach W√∂rtern
          </label>
          <input id="stopWords" type="number" min="100" step="100" value="2000" class="num" />
          <div class="hint">Stoppt erst nach Satzende (., !, ?).</div>
        </div>

        <div class="control">
          <label class="check">
            <input id="stopMinsOn" type="checkbox">
            Auto-Stop nach Minuten
          </label>
          <input id="stopMins" type="number" min="1" step="1" value="10" class="num" />
        </div>

        <div class="rowBtns">
          <button id="btnSaveSettings" class="btn">Speichern</button>
          <button id="btnLoadSettings" class="btn ghost">Laden</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- help modal -->
<div id="helpBackdrop" class="modalBackdrop hidden">
  <div class="modal">
    <div class="modalHeader">
      <h2>‚ùì Hilfe</h2>
      <button id="btnHelpClose" class="btn">Schlie√üen</button>
    </div>
    <div id="helpBody" class="helpBody"></div>
  </div>
</div>

<div id="donateBackdrop" class="modalBackdrop hidden">
  <div class="modal">
    <div class="modalHeader">
      <h2>‚òïÔ∏è Spenden</h2>
      <button id="btnDonateClose" class="btn">Schlie√üen</button>
    </div>

  <!-- donate modal -->
    <p class="small">
      Falls dir mein Tool gef√§llt und du mich unterst√ºtzen willst:
      <b>PayPal</b> oder <b>Bitcoin</b> ‚Äì super einfach. ‚ù§Ô∏è
    </p>

    <div class="ctaGrid">

      <!-- PayPal -->
      <div class="payCard">
        <div class="muted"><b>PayPal</b></div>

        <a class="payBtnBig" href="https://paypal.me/rophko" target="_blank" rel="noopener">
          <img class="paypalImg" alt="PayPal" src="data:image/svg+xml;utf8,
            <svg xmlns='http://www.w3.org/2000/svg' width='420' height='140' viewBox='0 0 420 140'>
              <rect width='420' height='140' rx='24' fill='%23f5f7ff'/>
              <text x='50%25' y='55%25' text-anchor='middle' font-family='Arial' font-size='44' fill='%23003087'>PayPal</text>
              <text x='50%25' y='80%25' text-anchor='middle' font-family='Arial' font-size='20' fill='%23003087'>Jetzt spenden</text>
            </svg>"/>
        </a>

        <div class="small muted">Tippen ‚Üí PayPal √∂ffnet direkt.</div>

        <div class="row" style="margin-top:6px;">
          <button id="btnPaypalQR" type="button" class="btn ghost">QR anzeigen</button>
        </div>

        <div id="paypalQrWrap" style="display:none; margin-top:8px;">
          <img id="paypalQrImg" class="qrImg" alt="PayPal QR" />
          <div class="small muted" style="margin-top:6px;">Scan ‚Üí PayPal-Link √∂ffnet.</div>
          <div id="paypalQrHint" class="small muted" style="margin-top:6px;"></div>
        </div>
      </div>

      <!-- Bitcoin -->
      <div class="payCard">
        <div class="muted"><b>Bitcoin</b></div>

        <div class="addrBox">
          <div class="small muted">Adresse</div>
          <div id="btcAddr" class="mono"></div>
          <div class="row" style="margin-top:6px;">
            <button id="btnCopyBtc" type="button" class="btn">Kopieren</button>
            <button id="btnBtcQR" type="button" class="btn ghost">QR anzeigen</button>
          </div>
        </div>

        <div id="btcQrWrap" style="display:none; margin-top:8px;">
          <img id="btcQrImg" class="qrImg" alt="Bitcoin QR" />
          <div class="small muted" style="margin-top:6px;">Scan ‚Üí Wallet √∂ffnet (bitcoin:).</div>
          <div id="btcQrHint" class="small muted" style="margin-top:6px;"></div>
        </div>
      </div>

    </div>
  </div>
</div>

  <!-- Bottom shelf -->
<footer id="shelf" class="shelf hidden">
  <div class="shelfHead">
    <div class="shelfTitle">Bibliothek</div>

    <div class="row">
      <button id="btnExportAll" class="btn" type="button">Export: Alles</button>
      <button id="btnExportSelected" class="btn ghost" type="button">Export: Auswahl</button>

      <label class="btn ghost" style="margin:0;">
        Import
        <input id="importFile" type="file" accept=".json,application/json" hidden />
      </label>
    </div>

    <label class="check small">
      <input id="pinShelf" type="checkbox" />
      fixieren
    </label>

    <button id="btnShelfClose" class="btn ghost" type="button">‚úï</button>
  </div>

  <div id="shelfList" class="shelfList muted">Noch keine B√ºcher gespeichert.</div>
</footer>


  <!-- libs -->
  <!-- <script src="./jszip.min.js"></script> -->
  <script src="./lib/epub.min.js"></script>
  <script src="./app.js?v=fix1"></script>


  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js").catch(console.error);
    }
  </script>
</body>
</html>
